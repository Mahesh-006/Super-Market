<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>SuperMart</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com" rel="preconnect"/>
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"/>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #111827;
            color: #F9FAFB;
        }
        .nav-button {
            display: inline-flex;
            align-items: center;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            font-weight: 500;
            transition: background-color 0.2s;
            text-decoration: none;
        }
        .nav-button:hover {
            background-color: #374151;
        }
        .nav-button.active {
            background-color: #4B5563;
        }
        .nav-button .material-icons {
            margin-right: 0.5rem;
            font-size: 1.25rem;
        }
        .category-card {
            background-color: #1F2937;
            border-radius: 0.5rem;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            transition: transform 0.2s;
            cursor: pointer;
        }
        .category-card:hover {
            transform: translateY(-0.25rem);
        }
        .category-card .material-icons {
            font-size: 2.5rem;
            color: #9CA3AF;
            margin-bottom: 0.75rem;
        }
        .cart-count {
            background: #DC2626;
            color: white;
            border-radius: 9999px;
            padding: 0.125rem 0.375rem;
            font-size: 0.75rem;
            font-weight: 600;
            margin-left: 0.25rem;
            min-width: 1.25rem;
            text-align: center;
        }
        .mobile-menu {
            display: none;
        }
        .mobile-menu.show {
            display: block;
        }
        @media (max-width: 768px) {
            .desktop-nav {
                display: none;
            }
            .mobile-menu-btn {
                display: block;
            }
        }
        @media (min-width: 769px) {
            .mobile-menu-btn {
                display: none;
            }
        }
    </style>
</head>
<body>
    <header class="py-4 px-6 shadow-md bg-gray-900 sticky top-0 z-50">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-2xl font-bold text-white">SuperMart</h1>
            <nav class="desktop-nav flex items-center space-x-4">
                <a class="nav-button active" href="index.html">
                    <span class="material-icons">home</span>
                    Home
                </a>
                <a class="nav-button" href="products.html">
                    <span class="material-icons">inventory_2</span>
                    Products
                </a>
                <a class="nav-button" href="cart.html">
                    <span class="material-icons">shopping_cart</span>
                    Cart
                    <span id="cartCount" class="cart-count" style="display: none;">0</span>
                </a>
                <a class="nav-button" href="profile.html">
                    <span class="material-icons">receipt_long</span>
                    Orders
                </a>
                <a class="nav-button" href="profile.html">
                    <span class="material-icons">account_circle</span>
                    Profile
                </a>
                <button id="themeToggle" class="text-gray-400 hover:text-white focus:outline-none">
                    <span class="material-icons">brightness_6</span>
                </button>
                <a id="authBtn" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-md text-sm inline-flex items-center" href="#">
                    <span class="material-icons mr-2">login</span>
                    Login
                </a>
            </nav>
            
            <!-- Mobile Menu Button -->
            <button class="mobile-menu-btn text-gray-400 hover:text-white focus:outline-none md:hidden" id="mobileMenuBtn">
                <span class="material-icons">menu</span>
            </button>
        </div>
        
        <!-- Mobile Menu -->
        <div class="mobile-menu mt-4 md:hidden" id="mobileMenu">
            <div class="flex flex-col space-y-2">
                <a class="nav-button active" href="index.html">
                    <span class="material-icons">home</span>
                    Home
                </a>
                <a class="nav-button" href="products.html">
                    <span class="material-icons">inventory_2</span>
                    Products
                </a>
                <a class="nav-button" href="cart.html">
                    <span class="material-icons">shopping_cart</span>
                    Cart
                    <span id="mobileCartCount" class="cart-count" style="display: none;">0</span>
                </a>
                <a class="nav-button" href="profile.html">
                    <span class="material-icons">receipt_long</span>
                    Orders
                </a>
                <a class="nav-button" href="profile.html">
                    <span class="material-icons">account_circle</span>
                    Profile
                </a>
                <a id="mobileAuthBtn" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-md text-sm inline-flex items-center justify-center" href="#">
                    <span class="material-icons mr-2">login</span>
                    Login
                </a>
            </div>
        </div>
    </header>

    <main class="container mx-auto mt-8 px-6">
        <section class="bg-gray-800 rounded-lg p-8 md:p-12 mb-12">
            <div class="md:w-3/4 lg:w-1/2">
                <h2 class="text-4xl md:text-5xl font-bold text-white mb-4">Fresh Groceries Delivered</h2>
                <p class="text-gray-300 mb-6 text-lg">
                    Get the freshest produce and everyday essentials delivered to your doorstep
                </p>
                <button class="bg-gray-700 hover:bg-gray-600 text-white font-semibold py-3 px-6 rounded-md text-base transition duration-200" onclick="window.location.href='products.html'">
                    Shop Now
                </button>
            </div>
        </section>

        <section>
            <h3 class="text-3xl font-bold text-white mb-8">Shop by Category</h3>
            <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-4 gap-6" id="categoryGrid">
                <div class="category-card" data-category="fruits">
                    <span class="material-icons">apple</span>
                    <span class="text-gray-200 font-medium">Fruits</span>
                </div>
                <div class="category-card" data-category="vegetables">
                    <span class="material-icons">eco</span>
                    <span class="text-gray-200 font-medium">Vegetables</span>
                </div>
                <div class="category-card" data-category="dairy">
                    <span class="material-icons">egg</span>
                    <span class="text-gray-200 font-medium">Dairy</span>
                </div>
                <div class="category-card" data-category="meat">
                    <span class="material-icons">kebab_dining</span>
                    <span class="text-gray-200 font-medium">Meat</span>
                </div>
                <div class="category-card" data-category="bakery">
                    <span class="material-icons">bakery_dining</span>
                    <span class="text-gray-200 font-medium">Bakery</span>
                </div>
                <div class="category-card" data-category="beverages">
                    <span class="material-icons">local_bar</span>
                    <span class="text-gray-200 font-medium">Beverages</span>
                </div>
                <div class="category-card" data-category="snacks">
                    <span class="material-icons">icecream</span>
                    <span class="text-gray-200 font-medium">Snacks</span>
                </div>
            </div>
        </section>

        <!-- Featured Products Section -->
        <section class="mt-16">
            <h3 class="text-3xl font-bold text-white mb-8">Featured Products</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6" id="featuredProducts">
                <!-- Products will be loaded here by JavaScript -->
            </div>
        </section>
    </main>

    <footer class="py-8 mt-12 border-t border-gray-700">
        <div class="container mx-auto px-6 text-center text-gray-400 text-sm">
            Â© 2025 SuperMart. All rights reserved.
        </div>
    </footer>

    <!-- Auth Modal -->
    <div id="authModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-gray-800 rounded-lg p-8 max-w-md w-full mx-4">
            <div class="flex justify-between items-center mb-6">
                <h2 id="authTitle" class="text-2xl font-bold text-white">Welcome Back</h2>
                <button class="text-gray-400 hover:text-white" onclick="closeAuthModal()">
                    <span class="material-icons">close</span>
                </button>
            </div>
            
            <div class="flex mb-6 bg-gray-700 rounded-lg p-1">
                <button id="loginTab" class="flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors bg-gray-600 text-white" onclick="switchAuthTab('login')">
                    Login
                </button>
                <button id="registerTab" class="flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors text-gray-300 hover:text-white" onclick="switchAuthTab('register')">
                    Register
                </button>
            </div>
            
            <form id="loginForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Email</label>
                    <input type="email" id="loginEmail" class="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Password</label>
                    <input type="password" id="loginPassword" class="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-md transition duration-200">
                    Sign In
                </button>
            </form>
            
            <form id="registerForm" class="space-y-4 hidden">
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Full Name</label>
                    <input type="text" id="registerName" class="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Email</label>
                    <input type="email" id="registerEmail" class="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Password</label>
                    <input type="password" id="registerPassword" class="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Confirm Password</label>
                    <input type="password" id="confirmPassword" class="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-md transition duration-200">
                    Create Account
                </button>
            </form>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg transform translate-x-full transition-transform duration-300 z-50">
        <div class="flex items-center">
            <span class="material-icons mr-2">check_circle</span>
            <span id="toastMessage">Success!</span>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/utils.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/cart.js"></script>
    <script src="js/main.js"></script>
    
    <script>
        // Mobile menu toggle
        document.getElementById('mobileMenuBtn').addEventListener('click', function() {
            const mobileMenu = document.getElementById('mobileMenu');
            mobileMenu.classList.toggle('show');
        });

        // Category navigation
        document.getElementById('categoryGrid').addEventListener('click', function(e) {
            const categoryCard = e.target.closest('.category-card');
            if (categoryCard) {
                const category = categoryCard.dataset.category;
                window.location.href = `products.html?category=${category}`;
            }
        });

        // Auth modal functions
        function openAuthModal() {
            document.getElementById('authModal').classList.remove('hidden');
            document.getElementById('authModal').classList.add('flex');
        }

        function closeAuthModal() {
            document.getElementById('authModal').classList.add('hidden');
            document.getElementById('authModal').classList.remove('flex');
        }

        function switchAuthTab(tab) {
            const loginTab = document.getElementById('loginTab');
            const registerTab = document.getElementById('registerTab');
            const loginForm = document.getElementById('loginForm');
            const registerForm = document.getElementById('registerForm');
            const authTitle = document.getElementById('authTitle');

            if (tab === 'login') {
                loginTab.classList.add('bg-gray-600', 'text-white');
                loginTab.classList.remove('text-gray-300');
                registerTab.classList.remove('bg-gray-600', 'text-white');
                registerTab.classList.add('text-gray-300');
                loginForm.classList.remove('hidden');
                registerForm.classList.add('hidden');
                authTitle.textContent = 'Welcome Back';
            } else {
                registerTab.classList.add('bg-gray-600', 'text-white');
                registerTab.classList.remove('text-gray-300');
                loginTab.classList.remove('bg-gray-600', 'text-white');
                loginTab.classList.add('text-gray-300');
                registerForm.classList.remove('hidden');
                loginForm.classList.add('hidden');
                authTitle.textContent = 'Create Account';
            }
        }

        // Auth button click handlers
        document.getElementById('authBtn').addEventListener('click', function(e) {
            e.preventDefault();
            if (authManager && authManager.isLoggedIn()) {
                authManager.logout();
            } else {
                openAuthModal();
            }
        });

        document.getElementById('mobileAuthBtn').addEventListener('click', function(e) {
            e.preventDefault();
            if (authManager && authManager.isLoggedIn()) {
                authManager.logout();
            } else {
                openAuthModal();
            }
        });

        // Form submissions
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            if (authManager) {
                authManager.login(email, password).then(success => {
                    if (success) {
                        closeAuthModal();
                        showToast('Login successful!', 'success');
                    } else {
                        showToast('Invalid credentials', 'error');
                    }
                }).catch(error => {
                    showToast('Login failed', 'error');
                });
            }
        });

        document.getElementById('registerForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            if (password !== confirmPassword) {
                showToast('Passwords do not match', 'error');
                return;
            }
            
            if (authManager) {
                authManager.signup(name, email, password).then(success => {
                    if (success) {
                        closeAuthModal();
                        showToast('Account created successfully!', 'success');
                    } else {
                        showToast('Registration failed', 'error');
                    }
                }).catch(error => {
                    showToast('Registration failed', 'error');
                });
            }
        });

        // Close modal when clicking outside
        document.getElementById('authModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeAuthModal();
            }
        });

        // Update auth buttons based on login status
        function updateAuthButtons() {
            const authBtn = document.getElementById('authBtn');
            const mobileAuthBtn = document.getElementById('mobileAuthBtn');
            
            if (authManager && authManager.isLoggedIn()) {
                const user = authManager.getCurrentUser();
                authBtn.innerHTML = `<span class="material-icons mr-2">logout</span>Logout`;
                mobileAuthBtn.innerHTML = `<span class="material-icons mr-2">logout</span>Logout`;
            } else {
                authBtn.innerHTML = `<span class="material-icons mr-2">login</span>Login`;
                mobileAuthBtn.innerHTML = `<span class="material-icons mr-2">login</span>Login`;
            }
        }

        // Update cart count
        function updateCartCount() {
            if (cartManager) {
                const count = cartManager.getItemCount();
                const cartCounts = document.querySelectorAll('#cartCount, #mobileCartCount');
                cartCounts.forEach(element => {
                    if (count > 0) {
                        element.textContent = count;
                        element.style.display = 'inline';
                    } else {
                        element.style.display = 'none';
                    }
                });
            }
        }

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            updateAuthButtons();
            updateCartCount();
            
            // Listen for auth changes
            if (window.eventEmitter) {
                window.eventEmitter.on('userLogin', updateAuthButtons);
                window.eventEmitter.on('userLogout', updateAuthButtons);
                window.eventEmitter.on('cartUpdated', updateCartCount);
            }
        });

        // Theme toggle (basic implementation)
        document.getElementById('themeToggle').addEventListener('click', function() {
            // This is a placeholder for theme toggle functionality
            showToast('Theme toggle coming soon!', 'info');
        });

        // Enhanced toast function
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');
            const icon = toast.querySelector('.material-icons');
            
            // Update message
            toastMessage.textContent = message;
            
            // Update styling based on type
            toast.className = 'fixed bottom-4 right-4 px-6 py-3 rounded-lg shadow-lg transform transition-transform duration-300 z-50';
            
            switch(type) {
                case 'success':
                    toast.classList.add('bg-green-600', 'text-white');
                    icon.textContent = 'check_circle';
                    break;
                case 'error':
                    toast.classList.add('bg-red-600', 'text-white');
                    icon.textContent = 'error';
                    break;
                case 'warning':
                    toast.classList.add('bg-yellow-600', 'text-white');
                    icon.textContent = 'warning';
                    break;
                case 'info':
                    toast.classList.add('bg-blue-600', 'text-white');
                    icon.textContent = 'info';
                    break;
            }
            
            // Show toast
            toast.classList.remove('translate-x-full');
            
            // Hide after 3 seconds
            setTimeout(() => {
                toast.classList.add('translate-x-full');
            }, 3000);
        }
    </script>
</body>
</html>